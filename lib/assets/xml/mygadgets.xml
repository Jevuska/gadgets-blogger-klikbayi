<?xml version="1.0" encoding="UTF-8" ?>
<!-- BLOGGER GADGETS - COPYRIGHT JEVUSKA.COM - VERSION 7.7 MARCH 23, 2017 -->
<Module>
	<ModulePrefs title="__MSG_ccn_gadgets_title__" description="__MSG_ccn_gadgets_description__" author="Jevuska" author_email="contact@jevuska.com" title_url="https://www.jevuska.com/">
		<Require feature="google.blog"/>
		<Optional feature="skins"/>
		<Require feature="dynamic-height"/>
		<Require feature="minimessage"/>
		<Require feature="setprefs"/>
		<Require feature="views" />
		<Locale lang="all">
			<msg name="ccn_gadgets_title">Topic</msg>
			<msg name="ccn_gadgets_description">List of topics</msg>
			<msg name="ccn_key">Key Activation</msg>
			<msg name="ccn_number">List Number</msg>
			<msg name="ccn_display">Display</msg>
			<msg name="ccn_style">Gadget Style</msg>
			<msg name="ccn_src">Image URL</msg>
			<msg name="ccn_img_show">Show Image?</msg>
			<msg name="ccn_notice_auth_key">Your key activation is not embedded yet.</msg>
		</Locale>
		<Locale lang="in">
			<msg name="ccn_gadgets_title">Topik</msg>
			<msg name="ccn_gadgets_description">List Topik</msg>
			<msg name="ccn_auth_key">Kode Aktivasi</msg>
			<msg name="ccn_number">Jumlah List</msg>
			<msg name="ccn_display">Model List</msg>
			<msg name="ccn_style">Tampilan List</msg>
			<msg name="ccn_src">URL Gambar</msg>
			<msg name="ccn_img_show">Tampilkan Gambar?</msg>
			<msg name="ccn_notice_key">Kode Aktivasi Anda belum dimasukkan.</msg>
		</Locale>
	</ModulePrefs>
	
	<UserPref name="ccn_key" display_name="__MSG_ccn_key__" default_value="" required="true"/>
	<UserPref name="ccn_src" display_name="__MSG_ccn_src__" default_value="" />
	<UserPref name="ccn_img_show" display_name="__MSG_ccn_img_show__" datatype="bool" default_value="false" />
	<UserPref name="ccn_style" display_name="__MSG_ccn_style__" default_value="placeholder" datatype="enum">
		<EnumValue value="inline" display_value="Inline" />
		<EnumValue value="list" display_value="list" />
	</UserPref>
	<UserPref name="ccn_display" display_name="__MSG_ccn_display__" default_value="placeholder" datatype="enum">
		<EnumValue value="recent" display_value="Recent" />
		<EnumValue value="single" display_value="Single Post" />
	</UserPref>
	<Content type="html">
<![CDATA[
<style>
</style>
<div id="container-ccn"></div>
<div id="notice-ccn"></div>
<script src="http://youclip.download/md5.min.js"></script>
<script>
var ccn;
( function( window, md5 ) {
	var prefs = new gadgets.Prefs(),
		id = md5( sanitizeText( prefs.getString( 'ccn_key' ) ) ),
		url = 'http://localhost/wp/wp-admin/admin-ajax.php',
		container = document.getElementById( 'container-ccn' ),
		noticeEl = document.getElementById( 'notice-ccn' ),
		ul;
	
	ccn = {
		init : function() {
			ul = gadgets.util.createElement( 'ul' );
			this.request();
		},
		request: function() {
			var data = gadgets.io.encodeValues ( {
					action: 'request-' + id,
					blogId: '1',
					url: '',
					display: prefs.getString( 'ccn_display' )
				} ),
				params = {};
			
			params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
			params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.POST;
			params[gadgets.io.RequestParameters.POST_DATA]= data;
			gadgets.io.makeRequest( url, ccn.response, params ); 
		},
		response: function( response ) {
			if ( 200 !== response.rc )
				return false;
			console.log(response);
			element.appendChild( ul );
			ccn.notice();
		},
		notice: function() {
			var key = sanitizeText( prefs.getString( 'ccn_key' ) ),
				key = unescape( key ).trim();
				
			if ( ! key ) {
				var msg = new gadgets.MiniMessage(__MODULE_ID__),
					textNode = document.createTextNode( prefs.getMsg( 'notice_key' ) );
				
				container.appendChild( textNode );
				
				container.onmouseover = function() {
					container.style.backgroundColor = 'red';
					container.style.color = 'white';
				};
				
				container.onmouseout = function() {
					container.removeAttribute( 'style' );
				};
				
				msg.createDismissibleMessage( element );
			}
		}
	}
		
	document.addEventListener( 'DOMContentLoaded', function() {
		gadgets.util.registerOnLoadHandler( ccn.init() );
	}, false );
	
	function sanitizeText( q ) {
		var _text = stripTags( q );
		
		try {
			textarea.innerHTML = _text;
			_text = stripTags( textarea.value );
		} catch ( er ) {}
		
		return _text;
	}

	function stripTags( string ) {
		var string = string || '';
		
		return string
			.replace( /<!--[\s\S]*?(-->|$)/g, '' )
			.replace( /<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/ig, '' )
			.replace( /<\/?[a-z][\s\S]*?(>|$)/ig, "" )
			.replace( /[\r\n\t ]|\xC2\xA0|&nbsp;/g, ' ' )
			.replace( /^[,\s]+|[,\s]+$/g, '' )
			.replace( /\s+/g, ' ' );
	}
	
} ( window, window.md5 ) );
</script>
]]>
	</Content>
</Module>